<!DOCTYPE html>
<html>
    <head>
        <title>The Harp and Fiddle</title>
        <base href='/'>
        <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" href="/img/favicon/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="/img/favicon/favicon-16x16.png" sizes="16x16">
        <link rel="manifest" href="/img/favicon/manifest.json">
        <link rel="mask-icon" href="/img/favicon/safari-pinned-tab.svg" color="#5bbad5">
        <link rel="shortcut icon" href="/img/favicon/favicon.ico">
        <link rel='stylesheet' type="text/css" href='/lib/bootstrap/css/bootstrap.min.css'>
        <link href="https://fonts.googleapis.com/css?family=Great+Vibes|Montserrat:100,200i,400|Open+Sans|Secular+One|Suez+One" rel="stylesheet">
        <link rel='stylesheet' href='/css/home.css'>
        <link href="//cdn-images.mailchimp.com/embedcode/classic-081711.css" rel="stylesheet" type="text/css">
        <link rel="stylesheet" href="/lib/fullcalendar/jquery-ui.min.css"/>
        <link rel="stylesheet" href="/lib/fullcalendar/fullcalendar.min.css"/>
        <link rel="stylesheet" href="/lib/fullcalendar/fullcalendar.print.css" media="print"/>
        <link rel="stylesheet" href="/lib/lightbox/css/lightbox.min.css"/>
        <link href='/lib/animate.css/animate.min.css' rel='stylesheet'>
        <link href='/lib/aos/dist/aos.css' rel='stylesheet'>
        <script type='text/javascript' src='/lib/jquery/jquery.min.js'></script>
        <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <script src="/lib/fullcalendar/moment.min.js"></script>
        <script src="/lib/fullcalendar/fullcalendar.min.js"></script>
        <script src="/lib/pdfjs/build/pdf.js"></script>
        <script type="text/javascript">
          !function(e,n){var t=document.createElement("script"),a=document.getElementsByTagName("script")[0];t.async=1,a.parentNode.insertBefore(t,a),t.onload=t.onreadystatechange=function(e,a){(a||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t=void 0,a||n&&n())},t.src=e}("https://embed-menu-preloader.untappdapi.com/embed-menu-preloader.min.js",function(){PreloadEmbedMenu("menu-container",6484,22214)});
        </script>
    </head>
    <body>
      <div id="overlay">
        <p id="close">Close X</p>
        <div class="menu-modal" id="menuContainer">
          <div id="menu-container" class="drinks-menu"></div>
        </div>
        <div class="contact-form">
          <form>
            <div class="alert alert-success successmail">Message sent!</div>
            <div class="alert alert-danger failmail">Bollocks, there's something wrong with the servers! Please try emailing declan@theharpandfiddle.com instead!</div>
            <div id="contact-inputs">
              <h1>Contact Us</h1>
              <input required class="form-control" id="name" type="text" placeholder="full name"/>
              <input required class="form-control" id="email" type="email" placeholder="email"/>
              <input class="form-control" id="phone" type="tel" placeholder="phone number"/>
              <input required class="form-control" id="subject" type="text" placeholder="subject"/>
              <textarea required class="form-control" id="message" placeholder="message"></textarea>
              <button class="btn btn-primary" id="contact-form-submit">Send</button>
            </div>
          </form>
        </div>
      </div>

      <div class="offscreen-nav-wrapper">
        <div class="offscreen-nav">
          <ul>
            <li><a href="#events">Events</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#social">Social</a></li>
            <li><a href="#reserve">Reserve</a></li>
            <li><a href="#menus">Menus</a></li>
            <li id="contact" href="contact-form">Contact</li>
          </ul>
        </div>
      </div>


      <nav>
        <div id="menu">
          <span></span><span></span><span></span><span></span><span></span><span></span>
        </div>
      </nav>

      <section id="intro">
        <img src="/img/logos/home1.png"/>
        <h2>A modern bar with an <span class="animated tada">Irish Flair</span></h2>
      </section>

      <div id="primary-container">
        <section id="events">
          <h1>What's Goin' On?</h1>
          <div id="featured-evs"></div>
        </section>

        <section id="about">
          <h1>Where to find us</h1>
          <div class="map-overlay"></div>
          <iframe data-aos="zoom-in-up" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2974.859471108635!2d-87.8322370853504!3d42.009562119007306!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x880fc9b7151ccd95%3A0xf4d931d39d0b7486!2sThe+Harp+And+Fiddle!5e0!3m2!1sen!2sus!4v1489964007207" frameborder="0" style="border:0" allowfullscreen></iframe>
          <p id="contact-info"><span id="address">The Harp and Fiddle<br/>110 Main St,<br/>Park Ridge, IL 60068</span><br/><a id="ph-num" href="tel:8477204466">(847) 720-4466</a><br/><span id="email">declan@theharpandfiddle.com</span></p>
          <table class="table">
            <thead>
              <th>Hours</th>
              <th></th>
            </thead>
            <tr>
              <td>Mon-Fri</td>
              <td>11am-2am</td>
            </tr>
            <tr>
              <td>Saturday</td>
              <td>11am-2am</td>
            </tr>
            <tr>
              <td>Sunday</td>
              <td>11am-2am</td>
            </tr>
          </table>
        </section>

        <section id="social">
          <h1>We're "on the line"</h1>
          <div id="ig-links"></div>
          <a>Clik here to see more!</a>
        </section>

        <section id="reserve">
          <h1>Reserve a Table</h1>
          <input style="display: none" name="dateval" id="dateval"/>
          <div id="datepicker"></div>
          <fieldset>
            <select name="time" id="time">
              <option value="1100" selected>11am</option>
              <option value="1130">11:30am</option>
              <option value="1200">12:00pm</option>
              <option value="1230">12:30pm</option>
              <option value="1300">1:00pm</option>
              <option value="1330">1:30pm</option>
              <option value="1400">2:00pm</option>
              <option value="1430">2:30pm</option>
              <option value="1500">3:00pm</option>
              <option value="1530">3:30pm</option>
              <option value="1600">4:00pm</option>
              <option value="1630">4:30pm</option>
              <option value="1700">5:00pm</option>
              <option value="1730">5:30pm</option>
              <option value="1800">6:00pm</option>
              <option value="1830">6:30pm</option>
              <option value="1900">7:00pm</option>
              <option value="1930">7:30pm</option>
              <option value="2000">8:00pm</option>
              <option value="2030">8:30pm</option>
              <option value="2100">9:00pm</option>
              <option value="2130">9:30pm</option>
            </select>
            <select name="party" id="party">
              <option value="1">1 person</option>
              <option value="2" selected>2 people</option>
              <option value="3">3 people</option>
              <option value="4">4 people</option>
              <option value="5">5 people</option>
              <option value="6">6 people</option>
            </select>
            <div id="btn-container">
              <button id="reserve-btn">Reserve Now</button>
            </div>
          </fieldset>
          <form>

          </form>
        </section>

        <section id="menus">
          <h1>Menu</h1>
          <div class="menu-box" id="brunch-menu" data-pt="brunch-menu" href="/img/menus/brunch.pdf"><h4>Brunch</h4></div>
          <div class="menu-box" id="lunch-menu" data-pt="lunch-menu" href="/img/menus/lunch.pdf"><h4>Lunch</h4></div>
          <div class="menu-box" id="dinner-menu" data-pt="dinner-menu" href="/img/menus/dinner.pdf"><h4>Dinner</h4></div>
          <div class="menu-box" id="beer-menu" data-pt="drinks-menu" href="beer-menu"><h4>Drinks</h4></div>
        </section>

        <footer>
          <!-- <ul>
            <li><img/></li>
            <li><img/></li>
            <li><img/></li>
          </ul> -->

          <ul>
            <li><a href="#events">Events</a></li>
            <li><a href="#about">About</a></li>
            <li><a href="#reserve">Reserve</a></li>
            <li><a href="#menus">Menu</a></li>
          </ul>

          <p>Site by // Sean Stapleton</p>

        </footer>
      </div>
    </body>
</html>
<script src="/lib/bootstrap/js/bootstrap.min.js"></script>
<script src='/lib/aos/dist/aos.js'></script>
<script type="text/javascript">
  AOS.init({
    duration: 1000
  });

  $(".map-overlay").click(function() {
    $(this).addClass("hide");
    $(this).removeClass("show");
  });

  $("#menu").click(function() {
    $(this).toggleClass("open");
    $('.offscreen-nav').toggleClass("onscreen");
  });

  $(".offscreen-nav a").click(function() {
    $("#menu").toggleClass("open");
    $('.offscreen-nav').toggleClass("onscreen");
  });

  $(document).scroll(function() {
    if ($(".map-overlay").hasClass("hide")) {
      $(".map-overlay").addClass("show");
      $(".map-overlay").removeClass("hide");
    }
  });

  $('#datepicker').datepicker({
      onSelect: function(dateText, inst) {
        $("input[name='dateval']").val(dateText);
      },
      minDate: 0
  });
  $("#time").selectmenu();
  $("#party").selectmenu();

  $("#reserve-btn").click(function() {
    var d = new Date($("input[name='dateval']").val()).toISOString().substring(0,10);
    var t = $("#time").val();
    var p = $("#party").val();
    window.open("https://www.yelp.com/reservations/the-harp-and-fiddle-park-ridge?date="+d+"&time="+t+"&covers="+p, "_blank");
  });

  $.post('/backendServices/insta', function(data) {
    var imgs = data.data.slice(0,4);
    console.log(imgs);
    for (var i = 0; i < imgs.length; i++) {
      var div = $("<div data-aos='zoom-in' class='soc-box'></div>");
      div.css("background-image", "url(" + imgs[i].images.standard_resolution.url+")");
      $("#ig-links").append(div);
    }
  });

  $.get('/backendServices/featuredEvents', function(data) {
    var evs = data.events;
    for (var i = 0; i < evs.length; i++) {
      var anchor = $('<a href='+evs[i].url+'></a>');
      var div = $("<div class='ev-box' data-aos='fade-up' data-aos-anchor-placement='center-bottom'></div>");
      if (evs[i].img) div.css("background-image", "linear-gradient(rgba(0,0,0,0.2), rgba(0,0,0,0.2)), url(" + evs[i].img + ")");
      div.append($("<h4></h4>").text(evs[i].title), $("<p></p>").text(evs[i].description));
      anchor.append(div);
      $("#featured-evs").append(anchor);
    }
  });

  $(".menu-box").click(function() {
    var pointer = $(this).attr("data-pt");
    $("#close").attr("data-pt",pointer);
    if ($("." + pointer)[0])
      $("."+pointer).toggleClass("show");
    else {
      displayMenu($(this).attr("href"), pointer);
    }
    $("#overlay").toggleClass("show");
    $("body").toggleClass("noscroll");
  });

  var displayMenu = function(src, pointer) {
    PDFJS.getDocument(src).promise.then(function(pdf) {
      renderNewPage(pdf, 1, pointer);
    });
  }

  var renderNewPage = function(pdf, num, pointer) {
    pdf.getPage(num).then(function(page) {
      var scale = 1.5;
      var viewport = page.getViewport(scale);

      var canvas = document.createElement("canvas");
      canvas.className += " menu-page show " + pointer;
      var context = canvas.getContext('2d');
      canvas.height = viewport.height;
      canvas.width = viewport.width;
      var renderContext = {
        canvasContext: context,
        viewport: viewport
      };
      page.render(renderContext).then(function() {
        $("#menuContainer").append(canvas);
        num++;
        if (num <= pdf.numPages) renderNewPage(pdf, num, pointer);
      });
    }, function(reason) {
      console.log("Error: " + reason);
    });
  }

  $("#close").click(function() {
    $("#overlay").toggleClass("show");
    $("."+$(this).attr("data-pt")).toggleClass("show");
    $("body").toggleClass("noscroll");
  });

  $(function() {
    $('a[href*="#"]:not([href="#"])').click(function() {
      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) +']');
        if (target.length) {
          $('html, body').animate({
            scrollTop: target.offset().top
          }, 2000);
          return false;
        }
      }
    });
  });

  $("#contact").click(function() {
    $("#overlay").toggleClass("show");
    $(".menu-modal").toggleClass("show");
    $("body").toggleClass("noscroll");
    $("#close").attr("href",$(this).attr("href"));
  });

  $("#contact-form-submit").click(function() {
    var formData = {
      name: $("#name").val(),
      email: $("#email").val(),
      phone: $("#phone").val(),
      subject: $("#subject").val(),
      message: $("#message").val()
    }

    $.post("/backendServices/sendMessage", formData, function(data) {
      if (data.success) $("div.successmail").toggleClass("show");
      else {
        $("div.failmail").toggleClass("show");
      }
      $("#contact-inputs").toggleClass("hide");
    });
  });
</script>
